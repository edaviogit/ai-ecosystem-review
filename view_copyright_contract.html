<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>版权合约查看器</title>
    <script src="https://cdn.jsdelivr.net/npm/web3@1.10.0/dist/web3.min.js"></script>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
        }
        .container {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 30px;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        .info-card {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
            border-left: 4px solid #4CAF50;
        }
        .hash-display {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            word-break: break-all;
            margin: 10px 0;
        }
        .button {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            margin: 10px 5px;
            transition: all 0.3s;
        }
        .button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        .status {
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
        }
        .status.success {
            background: rgba(76, 175, 80, 0.3);
            border: 1px solid #4CAF50;
        }
        .status.error {
            background: rgba(244, 67, 54, 0.3);
            border: 1px solid #f44336;
        }
        .status.info {
            background: rgba(33, 150, 243, 0.3);
            border: 1px solid #2196F3;
        }
        .link {
            color: #81C784;
            text-decoration: none;
        }
        .link:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🔍 AI文档版权合约查看器</h1>
            <p>查看您在 Polygon 区块链上的版权保护记录</p>
        </div>

        <div class="info-card">
            <h3>📋 合约基本信息</h3>
            <p><strong>合约地址:</strong></p>
            <div class="hash-display">0xF4ca090fB8edfE207a8FCe21ac383CC8A769fB5A</div>
            <p><strong>网络:</strong> Polygon Mainnet (Chain ID: 137)</p>
            <p><strong>合约类型:</strong> CopyrightRegistry</p>
            <p><strong>部署区块:</strong> 74345428</p>
            <p><strong>部署者:</strong> 0xaDb1fc541dEbc2c2336f0A60f36B15b718b9D79a</p>
        </div>

        <div class="info-card">
            <h3>📄 已注册版权信息</h3>
            <p><strong>文档标题:</strong> AI计算生态综述：选对技术栈</p>
            <p><strong>作者姓名:</strong> Lu Dawei (陆大为)</p>
            <p><strong>作者地址:</strong> 0xaDb1fc541dEbc2c2336f0A60f36B15b718b9D79a</p>
            <p><strong>许可证:</strong> CC-BY-4.0 (开源许可)</p>
            <p><strong>内容哈希:</strong></p>
            <div class="hash-display">0194f60c68f8e65582b16a71153ea864bbec06a50f42310cfe6a9794598130d5</div>
            <p><strong>注册区块:</strong> 74345904</p>
            <p><strong>注册状态:</strong> ✅ 已确认</p>
        </div>

        <div class="info-card">
            <h3>🔗 区块链浏览器链接</h3>
            <p><strong>合约页面:</strong></p>
            <p><a href="https://polygonscan.com/address/0xF4ca090fB8edfE207a8FCe21ac383CC8A769fB5A" target="_blank" class="link">
                在 PolygonScan 上查看合约 →
            </a></p>
            
            <p><strong>部署交易:</strong></p>
            <p><a href="https://polygonscan.com/tx/0x1e918f4e9e7c6379af6eb5aa386c90047c5ce48dac496bb03baa4ed8dd5c8a04" target="_blank" class="link">
                查看部署交易 →
            </a></p>
            
            <p><strong>注册交易:</strong></p>
            <p><a href="https://polygonscan.com/address/0xF4ca090fB8edfE207a8FCe21ac383CC8A769fB5A" target="_blank" class="link">
                在合约页面查看所有交易 →
            </a></p>
        </div>

        <div class="info-card">
            <h3>🛠️ 合约功能</h3>
            <button class="button" onclick="verifyCopyright()">🔍 验证版权</button>
            <button class="button" onclick="getCopyrightInfo()">📋 获取详细信息</button>
            <button class="button" onclick="getAuthorWorks()">📚 查看作者作品</button>
            <div id="result-display"></div>
        </div>

        <div class="info-card">
            <h3>💡 使用说明</h3>
            <ul>
                <li><strong>验证版权:</strong> 确认文档的版权保护状态</li>
                <li><strong>获取详细信息:</strong> 查看完整的版权记录</li>
                <li><strong>查看作者作品:</strong> 列出该作者的所有注册作品</li>
                <li><strong>区块链浏览器:</strong> 在 PolygonScan 上查看完整的链上记录</li>
            </ul>
        </div>

        <div class="info-card">
            <h3>🎯 验证方法</h3>
            <p><strong>任何人都可以验证这个版权记录：</strong></p>
            <ol>
                <li>访问 <a href="https://remix.ethereum.org" target="_blank" class="link">Remix IDE</a></li>
                <li>连接到 Polygon 网络</li>
                <li>使用合约地址: <code>0xF4ca090fB8edfE207a8FCe21ac383CC8A769fB5A</code></li>
                <li>调用 <code>verifyCopyright</code> 函数</li>
                <li>输入文档哈希、作者地址和标题</li>
                <li>应该返回 <code>true</code> ✅</li>
            </ol>
        </div>
    </div>

    <script>
        const CONTRACT_ADDRESS = '0xF4ca090fB8edfE207a8FCe21ac383CC8A769fB5A';
        const CONTENT_HASH = '0194f60c68f8e65582b16a71153ea864bbec06a50f42310cfe6a9794598130d5';
        const AUTHOR_ADDRESS = '0xaDb1fc541dEbc2c2336f0A60f36B15b718b9D79a';
        const AUTHOR_NAME = 'Lu Dawei (陆大为)';
        const TITLE = 'AI计算生态综述：选对技术栈';

        const CONTRACT_ABI = [
            {
                "inputs": [
                    {"name": "_contentHash", "type": "string"},
                    {"name": "_author", "type": "address"},
                    {"name": "_title", "type": "string"}
                ],
                "name": "verifyCopyright",
                "outputs": [{"name": "", "type": "bool"}],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [
                    {"name": "_contentHash", "type": "string"},
                    {"name": "_author", "type": "address"},
                    {"name": "_title", "type": "string"}
                ],
                "name": "getCopyright",
                "outputs": [
                    {"name": "", "type": "string"},
                    {"name": "", "type": "string"},
                    {"name": "", "type": "address"},
                    {"name": "", "type": "uint256"},
                    {"name": "", "type": "string"}
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [{"name": "_author", "type": "address"}],
                "name": "getAuthorWorks",
                "outputs": [{"name": "", "type": "bytes32[]"}],
                "stateMutability": "view",
                "type": "function"
            }
        ];

        let web3;
        let contract;

        async function initWeb3() {
            if (typeof window.ethereum !== 'undefined') {
                web3 = new Web3(window.ethereum);
            } else {
                web3 = new Web3('https://polygon-rpc.com');
            }
            contract = new web3.eth.Contract(CONTRACT_ABI, CONTRACT_ADDRESS);
        }

        async function verifyCopyright() {
            const resultDiv = document.getElementById('result-display');
            resultDiv.innerHTML = '<div class="status info">🔍 正在验证版权...</div>';
            
            try {
                await initWeb3();
                const result = await contract.methods.verifyCopyright(
                    CONTENT_HASH,
                    AUTHOR_ADDRESS,
                    TITLE
                ).call();
                
                if (result) {
                    resultDiv.innerHTML = '<div class="status success">✅ 版权验证成功！该文档确实受到区块链保护。</div>';
                } else {
                    resultDiv.innerHTML = '<div class="status error">❌ 版权验证失败！未找到相关记录。</div>';
                }
            } catch (error) {
                resultDiv.innerHTML = `<div class="status error">❌ 验证过程出错: ${error.message}</div>`;
            }
        }

        async function getCopyrightInfo() {
            const resultDiv = document.getElementById('result-display');
            resultDiv.innerHTML = '<div class="status info">📋 正在获取版权信息...</div>';
            
            try {
                await initWeb3();
                const result = await contract.methods.getCopyright(
                    CONTENT_HASH,
                    AUTHOR_ADDRESS,
                    TITLE
                ).call();
                
                const timestamp = new Date(result[3] * 1000).toLocaleString('zh-CN');
                
                resultDiv.innerHTML = `
                    <div class="status success">
                        <h4>📋 版权详细信息</h4>
                        <p><strong>内容哈希:</strong> ${result[0]}</p>
                        <p><strong>标题:</strong> ${result[1]}</p>
                        <p><strong>作者:</strong> ${result[2]}</p>
                        <p><strong>注册时间:</strong> ${timestamp}</p>
                        <p><strong>许可证:</strong> ${result[4]}</p>
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = `<div class="status error">❌ 获取信息失败: ${error.message}</div>`;
            }
        }

        async function getAuthorWorks() {
            const resultDiv = document.getElementById('result-display');
            resultDiv.innerHTML = '<div class="status info">📚 正在查询作者作品...</div>';
            
            try {
                await initWeb3();
                const result = await contract.methods.getAuthorWorks(AUTHOR_ADDRESS).call();
                
                resultDiv.innerHTML = `
                    <div class="status success">
                        <h4>📚 作者作品列表</h4>
                        <p><strong>作者姓名:</strong> ${AUTHOR_NAME}</p>
                        <p><strong>作者地址:</strong> ${AUTHOR_ADDRESS}</p>
                        <p><strong>作品数量:</strong> ${result.length}</p>
                        <p><strong>作品ID:</strong></p>
                        ${result.map(id => `<div class="hash-display">${id}</div>`).join('')}
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = `<div class="status error">❌ 查询失败: ${error.message}</div>`;
            }
        }

        // 页面加载时自动验证
        window.addEventListener('load', function() {
            setTimeout(verifyCopyright, 1000);
        });
    </script>
</body>
</html> 